<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <title>Painel Administrativo - Construtora Premium</title>
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/admin.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="admin-body">
    <div class="admin-sidebar-overlay" id="adminSidebarOverlay" onclick="closeAdminSidebar()"></div>
    <!-- Admin Header -->
    <header class="admin-header">
        <div class="admin-nav">
            <button class="admin-menu-toggle" id="adminMenuToggle" onclick="toggleAdminSidebar()" aria-label="Menu">
                <i class="fas fa-bars"></i>
            </button>
            <div class="admin-brand">
                <h1><i class="fas fa-building"></i> Admin Panel</h1>
            </div>
            <div class="admin-user">
                <div class="notification-bell" onclick="showNotificationsPanel()">
                    <i class="fas fa-bell"></i>
                    <span id="notificationBadge" class="notification-badge">0</span>
                </div>
                <span id="adminUserName">Administrador</span>
                <button class="btn-logout" onclick="adminLogout()">
                    <i class="fas fa-sign-out-alt"></i> Sair
                </button>
            </div>
        </div>
    </header>

    <!-- Admin Sidebar -->
    <aside class="admin-sidebar">
        <nav class="sidebar-nav">
            <ul>
                <li class="nav-item active">
                    <a href="#dashboard" onclick="showSection('dashboard'); closeAdminSidebar();">
                        <i class="fas fa-chart-dashboard"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#properties" onclick="showSection('properties'); closeAdminSidebar();">
                        <i class="fas fa-home"></i>
                        <span>Imóveis</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#reservations" onclick="showSection('reservations'); closeAdminSidebar();">
                        <i class="fas fa-calendar-check"></i>
                        <span>Reservas</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#sales" onclick="showSection('sales'); closeAdminSidebar();">
                        <i class="fas fa-handshake"></i>
                        <span>Vendas</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#repairs" onclick="showSection('repairs'); closeAdminSidebar();">
                        <i class="fas fa-tools"></i>
                        <span>Reparos</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#brokers" onclick="showSection('brokers'); closeAdminSidebar();">
                        <i class="fas fa-users"></i>
                        <span>Corretores</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#whatsapp-leads" onclick="showSection('whatsapp-leads'); closeAdminSidebar();">
                        <i class="fab fa-whatsapp"></i>
                        <span>Leads WhatsApp</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#analytics" onclick="showSection('analytics'); closeAdminSidebar();">
                        <i class="fas fa-chart-line"></i>
                        <span>Analytics do Site</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#reports" onclick="showSection('reports'); closeAdminSidebar();">
                        <i class="fas fa-chart-bar"></i>
                        <span>Relatórios</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#notifications" onclick="showSection('notifications'); closeAdminSidebar();">
                        <i class="fas fa-bell"></i>
                        <span>Notificações</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#settings" onclick="showSection('settings'); closeAdminSidebar();">
                        <i class="fas fa-cog"></i>
                        <span>Configurações</span>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>

    <!-- Admin Main Content -->
    <main class="admin-main">
        <!-- Dashboard Section -->
        <section id="dashboard" class="admin-section active">
            <div class="section-header">
                <h2>Dashboard</h2>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="refreshDashboard()">
                        <i class="fas fa-refresh"></i> Atualizar
                    </button>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-home"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalProperties">0</h3>
                        <p>Total de Imóveis</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon available">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="availableProperties">0</h3>
                        <p>Disponíveis</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon reserved">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="reservedProperties">0</h3>
                        <p>Reservados</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon sold">
                        <i class="fas fa-handshake"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="soldProperties">0</h3>
                        <p>Vendidos</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalBrokers">0</h3>
                        <p>Corretores Ativos</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalValue">R$ 0</h3>
                        <p>Valor Total</p>
                    </div>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Atividade Recente</h3>
                    <div id="recentActivity" class="activity-list">
                        <!-- Activity items will be loaded here -->
                    </div>
                </div>
                
                <div class="dashboard-card">
                    <h3>Reservas Expirando</h3>
                    <div id="expiringReservations" class="reservations-list">
                        <!-- Expiring reservations will be loaded here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Properties Section -->
        <section id="properties" class="admin-section">
            <div class="section-header">
                <h2>Gerenciar Imóveis</h2>
                <div class="header-actions">
                    <button class="btn btn-success" onclick="showAddPropertyModal()">
                        <i class="fas fa-plus"></i> Adicionar Imóvel
                    </button>
                    <button class="btn btn-secondary" onclick="exportProperties()">
                        <i class="fas fa-download"></i> Exportar
                    </button>
                </div>
            </div>

            <!-- Properties Filters -->
            <div class="admin-filters">
                <div class="filter-group">
                    <label>Tipo:</label>
                    <select id="adminTypeFilter">
                        <option value="">Todos</option>
                        <option value="apartamento">Apartamento</option>
                        <option value="casa">Casa</option>
                        <option value="cobertura">Cobertura</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Status:</label>
                    <select id="adminStatusFilter">
                        <option value="">Todos</option>
                        <option value="disponivel">Disponível</option>
                        <option value="reservado">Reservado</option>
                        <option value="vendido">Vendido</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Buscar:</label>
                    <input type="text" id="adminSearchInput" placeholder="Título, localização...">
                </div>
            </div>

            <!-- Properties Table -->
            <div class="admin-table-container">
                <table class="admin-table" id="propertiesTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Título</th>
                            <th>Tipo</th>
                            <th>Localização</th>
                            <th>Preço</th>
                            <th>Status</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="propertiesTableBody">
                        <!-- Property rows will be loaded here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Reservations Section -->
        <section id="reservations" class="admin-section">
            <div class="section-header">
                <h2>Gerenciar Reservas</h2>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="importReservasFromPdf()" title="Importar reservas do data/pdf-prontos-a-venda-import.json (só corretores cadastrados)">
                        <i class="fas fa-file-import"></i> Importar do PDF
                    </button>
                    <button class="btn btn-secondary" onclick="exportReservations()">
                        <i class="fas fa-download"></i> Exportar
                    </button>
                </div>
            </div>

            <!-- Reservations Table -->
            <div class="admin-table-container">
                <table class="admin-table" id="reservationsTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Imóvel</th>
                            <th>Corretor</th>
                            <th>Cliente</th>
                            <th>Data</th>
                            <th>Expira em</th>
                            <th>Status</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="reservationsTableBody">
                        <!-- Reservation rows will be loaded here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Sales Section -->
        <section id="sales" class="admin-section">
            <div class="section-header">
                <h2>Cadastro de Vendas</h2>
            </div>
            
            <div class="admin-form-container">
                <form id="saleForm" class="property-form" onsubmit="handleSaleFormSubmission(event); return false;">
                    <div class="form-group">
                        <label>Imóvel *</label>
                        <select id="saleProperty" required>
                            <option value="">Selecione um imóvel</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Unidade (opcional)</label>
                        <input type="text" id="saleUnitCode" placeholder="Ex: 101, Casa 05">
                    </div>
                    <div class="form-group">
                        <label>Nome do Cliente *</label>
                        <input type="text" id="saleClientName" required>
                    </div>
                    <div class="form-group">
                        <label id="saleClientCPFLabel">CPF/CNPJ do Cliente *</label>
                        <input type="text" id="saleClientCPF" required placeholder="CPF: 000.000.000-00 ou CNPJ: 00.000.000/0001-00">
                    </div>
                    <div class="form-group">
                        <label>Email do Cliente *</label>
                        <input type="email" id="saleClientEmail" required>
                    </div>
                    <div class="form-group">
                        <label>Telefone do Cliente</label>
                        <input type="tel" id="saleClientPhone" placeholder="(00) 00000-0000">
                    </div>
                    <div class="form-group">
                        <label>Valor de Venda (R$) *</label>
                        <input type="text" id="salePrice" required placeholder="0,00">
                    </div>
                    <div class="form-group">
                        <label>Nº do Contrato (opcional)</label>
                        <input type="text" id="saleContractNumber">
                    </div>
                    <div id="saleContractPhotosGroup" class="form-group" style="display:none">
                        <label>Fotos do contrato/escritura (Caixa) *</label>
                        <input type="file" id="saleContractPhotos" accept="image/*,.pdf" multiple>
                        <small class="form-hint">Obrigatório anexar pelo menos 1 foto ou PDF do contrato de venda.</small>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i> Registrar Venda
                    </button>
                </form>
            </div>
            
            <div class="admin-table-container">
                <table class="admin-table" id="salesTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Imóvel</th>
                            <th>Cliente</th>
                            <th>CPF</th>
                            <th>Email</th>
                            <th>Valor</th>
                            <th>Data</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="salesTableBody">
                        <!-- Sales rows will be loaded here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Repairs Section -->
        <section id="repairs" class="admin-section">
            <div class="section-header">
                <h2><i class="fas fa-tools"></i> Solicitações de Reparo</h2>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="forceRepairsSync()" title="Limpar cache e buscar do servidor">
                        <i class="fas fa-sync-alt"></i> Forçar sync
                    </button>
                    <button class="btn btn-primary" onclick="loadAdminRepairs()">
                        <i class="fas fa-refresh"></i> Atualizar
                    </button>
                </div>
            </div>
            <div id="repairSyncStatus" class="repair-sync-status" style="display:none;margin-bottom:15px;padding:12px;border-radius:8px;"></div>
            <div class="admin-table-container">
                <table class="admin-table" id="adminRepairsTable">
                    <thead>
                        <tr>
                            <th>Protocolo</th>
                            <th>Cliente</th>
                            <th>Email</th>
                            <th>Imóvel</th>
                            <th>Localização</th>
                            <th>Status</th>
                            <th>Data</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="adminRepairsTableBody">
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Brokers Section -->
        <section id="brokers" class="admin-section">
            <div class="section-header">
                <h2>Gerenciar Corretores</h2>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="loadBrokersData()" title="Atualizar lista do Firestore">
                        <i class="fas fa-refresh"></i> Atualizar
                    </button>
                    <button id="btnAddBroker" class="btn btn-success" onclick="showAddBrokerModal()" style="display:none">
                        <i class="fas fa-plus"></i> Adicionar Corretor
                    </button>
                </div>
            </div>

            <!-- Brokers Table -->
            <div class="admin-table-container">
                <table class="admin-table" id="brokersTable">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Nome</th>
                            <th>Email</th>
                            <th>Telefone</th>
                            <th>CRECI</th>
                            <th>Status</th>
                            <th>Data Cadastro</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="brokersTableBody">
                        <!-- Broker rows will be loaded here -->
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Reports Section -->
        <section id="reports" class="admin-section">
            <div class="section-header">
                <h2>Relatórios</h2>
            </div>

            <div class="reports-grid">
                <div class="report-card">
                    <h3>Vendas por Período</h3>
                    <div class="report-controls">
                        <input type="date" id="salesStartDate">
                        <input type="date" id="salesEndDate">
                        <button class="btn btn-primary" onclick="generateSalesReport()">Gerar</button>
                    </div>
                    <canvas id="salesChart"></canvas>
                </div>

                <div class="report-card">
                    <h3>Imóveis por Tipo</h3>
                    <canvas id="typeChart"></canvas>
                </div>

                <div class="report-card">
                    <h3>Performance dos Corretores</h3>
                    <div id="brokerPerformance" class="performance-list">
                        <!-- Broker performance will be loaded here -->
                    </div>
                </div>
            </div>
        </section>

        <!-- Notifications Section -->
        <section id="notifications" class="admin-section">
            <div class="section-header">
                <h2>Central de Notificações</h2>
                <div class="header-actions">
                    <button class="btn btn-secondary" onclick="markAllNotificationsRead()">
                        <i class="fas fa-check-double"></i> Marcar Todas como Lidas
                    </button>
                </div>
            </div>

            <!-- Notification Filters -->
            <div class="notification-filters">
                <button class="filter-btn active" onclick="filterNotifications('all')">Todas</button>
                <button class="filter-btn" onclick="filterNotifications('pending')">Pendentes</button>
                <button class="filter-btn" onclick="filterNotifications('reservation_request')">Solicitações de Reserva</button>
                <button class="filter-btn" onclick="filterNotifications('reservation_expiring')">Reservas Expirando</button>
                <button class="filter-btn" onclick="filterNotifications('document_request')">Solicitações de Documentos</button>
            </div>

            <!-- Notifications List -->
            <div id="notificationsList" class="notifications-list">
                <!-- Notifications will be loaded here -->
            </div>
        </section>

        <!-- WhatsApp Leads Section -->
        <section id="whatsapp-leads" class="admin-section">
            <div class="section-header">
                <h2><i class="fab fa-whatsapp"></i> Leads WhatsApp</h2>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="loadWhatsAppLeads()">
                        <i class="fas fa-refresh"></i> Atualizar
                    </button>
                </div>
            </div>

            <div class="stats-grid wa-stats-grid">
                <div class="stat-card">
                    <div class="stat-icon" style="background:#25d366;">
                        <i class="fas fa-users"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="waLeadsTotal">0</h3>
                        <p>Total de Leads</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background:#3498db;">
                        <i class="fas fa-user-plus"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="waLeadsNovo">0</h3>
                        <p>Novos</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background:#f39c12;">
                        <i class="fas fa-user-check"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="waLeadsQualificado">0</h3>
                        <p>Qualificados</p>
                    </div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background:#e74c3c;">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="waLeadsAgendado">0</h3>
                        <p>Agendados</p>
                    </div>
                </div>
            </div>

            <div class="wa-leads-filters">
                <select id="waFilterStatus" onchange="filterWALeads()">
                    <option value="">Todos os status</option>
                    <option value="novo">Novos</option>
                    <option value="qualificado">Qualificados</option>
                    <option value="agendado">Agendados</option>
                    <option value="convertido">Convertidos</option>
                    <option value="encaminhado">Encaminhados</option>
                </select>
                <input type="text" id="waSearchInput" placeholder="Buscar por nome ou telefone..." oninput="filterWALeads()">
            </div>

            <div class="wa-leads-table-container">
                <table class="wa-leads-table">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Telefone</th>
                            <th>Renda</th>
                            <th>Imóveis</th>
                            <th>Status</th>
                            <th>Data</th>
                            <th>Ações</th>
                        </tr>
                    </thead>
                    <tbody id="waLeadsTableBody">
                        <tr><td colspan="7" class="loading-msg">Carregando leads...</td></tr>
                    </tbody>
                </table>
            </div>

            <div id="waLeadDetailModal" class="wa-lead-modal" style="display:none;">
                <div class="wa-lead-modal-content">
                    <div class="wa-lead-modal-header">
                        <h3 id="waLeadDetailTitle">Detalhes do Lead</h3>
                        <button onclick="closeLeadDetail()" class="close-panel">&times;</button>
                    </div>
                    <div id="waLeadDetailBody" class="wa-lead-modal-body"></div>
                </div>
            </div>
        </section>

        <!-- Analytics Section -->
        <section id="analytics" class="admin-section">
            <div class="section-header">
                <h2><i class="fas fa-chart-line"></i> Analytics do Site</h2>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="loadAnalytics()">
                        <i class="fas fa-refresh"></i> Atualizar
                    </button>
                </div>
            </div>

            <div id="analyticsContent">
                <div class="stats-grid analytics-stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background:#3b82f6;">
                            <i class="fas fa-eye"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="analyticsVisitsToday">0</h3>
                            <p>Visitas Hoje</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background:#10b981;">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="analyticsUniqueToday">0</h3>
                            <p>Únicos Hoje</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background:#8b5cf6;">
                            <i class="fas fa-calendar-week"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="analyticsVisitsWeek">0</h3>
                            <p>Visitas na Semana</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background:#f59e0b;">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="analyticsVisitsMonth">0</h3>
                            <p>Visitas no Mês</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background:#ec4899;">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="analyticsUniqueMonth">0</h3>
                            <p>Únicos no Mês</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background:#06b6d4;">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="analyticsMobilePercent">0%</h3>
                            <p>Acesso Mobile</p>
                        </div>
                    </div>
                </div>

                <div class="analytics-chart-row">
                    <div class="analytics-chart-card analytics-chart-wide">
                        <h3>Visitas nos Últimos 30 Dias</h3>
                        <div class="analytics-chart-container">
                            <canvas id="analyticsVisitsChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="analytics-chart-row">
                    <div class="analytics-chart-card">
                        <h3>Dispositivos</h3>
                        <div class="analytics-chart-container-sm">
                            <canvas id="analyticsDevicesChart"></canvas>
                        </div>
                    </div>
                    <div class="analytics-chart-card">
                        <h3>Navegadores</h3>
                        <div class="analytics-chart-container-sm">
                            <canvas id="analyticsBrowsersChart"></canvas>
                        </div>
                    </div>
                </div>

                <div class="analytics-chart-row">
                    <div class="analytics-chart-card">
                        <h3>Páginas Mais Visitadas</h3>
                        <div class="analytics-table-scroll">
                            <table class="analytics-table">
                                <thead>
                                    <tr>
                                        <th>Página</th>
                                        <th>Visitas</th>
                                        <th>Únicos</th>
                                        <th>%</th>
                                    </tr>
                                </thead>
                                <tbody id="analyticsPagesBody">
                                    <tr><td colspan="4" style="text-align:center;color:#999;">Carregando...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="analytics-chart-card">
                        <h3>Últimas Visitas</h3>
                        <div class="analytics-table-scroll analytics-table-tall">
                            <table class="analytics-table">
                                <thead>
                                    <tr>
                                        <th>Data</th>
                                        <th>Página</th>
                                        <th>Dispositivo</th>
                                        <th>Navegador</th>
                                        <th>SO</th>
                                        <th>Visitante</th>
                                    </tr>
                                </thead>
                                <tbody id="analyticsRecentBody">
                                    <tr><td colspan="6" style="text-align:center;color:#999;">Carregando...</td></tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Settings Section -->
        <section id="settings" class="admin-section">
            <div class="section-header">
                <h2>Configurações</h2>
            </div>

            <div class="settings-grid">
                <div class="settings-card">
                    <h3>Configurações Gerais</h3>
                    <form id="generalSettingsForm">
                        <div class="form-group">
                            <label>Nome da Empresa:</label>
                            <input type="text" id="companyName" value="B F Marques Empreendimentos">
                        </div>
                        <div class="form-group">
                            <label>Email de Contato:</label>
                            <input type="email" id="contactEmail" value="bfmarquesempreendimentos@gmail.com">
                        </div>
                        <div class="form-group">
                            <label>Telefone:</label>
                            <input type="tel" id="contactPhone" value="(21) 99759-0814">
                        </div>
                        <button type="submit" class="btn btn-primary">Salvar</button>
                    </form>
                </div>

                <div class="settings-card">
                    <h3>Configurações de Reserva</h3>
                    <form id="reservationSettingsForm">
                        <div class="form-group">
                            <label>Tempo de Reserva (horas):</label>
                            <input type="number" id="reservationHours" value="48" min="1" max="168">
                        </div>
                        <div class="form-group">
                            <label>Máximo de Reservas por Corretor:</label>
                            <input type="number" id="maxReservations" value="5" min="1" max="20">
                        </div>
                        <div class="form-group checkbox-group">
                            <label>
                                <input type="checkbox" id="autoApproveReservations"> 
                                Aprovar reservas automaticamente
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary">Salvar</button>
                    </form>
                </div>

                <div class="settings-card">
                    <h3>Configurações de Documentos</h3>
                    <form id="documentSettingsForm">
                        <div class="form-group">
                            <label>Tempo de Acesso aos Documentos (dias):</label>
                            <input type="number" id="documentAccessDays" value="7" min="1" max="30">
                        </div>
                        <div class="form-group checkbox-group">
                            <label>
                                <input type="checkbox" id="autoApproveDocuments"> 
                                Aprovar acesso aos documentos automaticamente
                            </label>
                        </div>
                        <button type="submit" class="btn btn-primary">Salvar</button>
                    </form>
                </div>
                
                <div class="settings-card">
                    <h3>Backup e Inventário</h3>
                    <p>Baixe um backup completo das informações (clientes, imóveis, reservas, reparos, emails e histórico).</p>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 15px;">
                        <button type="button" class="btn btn-primary" onclick="exportSystemBackup()">
                            <i class="fas fa-download"></i> Baixar Backup
                        </button>
                        <label class="btn btn-secondary" style="cursor: pointer; margin: 0;">
                            <i class="fas fa-upload"></i> Importar Backup
                            <input type="file" id="backupFileInput" accept=".json" style="display: none;" onchange="importSystemBackup(event)">
                        </label>
                    </div>
                    <small style="display: block; margin-top: 10px; color: #666;">Use este recurso para garantir o inventário completo das informações.</small>
                </div>
            </div>
        </section>
    </main>

    <!-- Property Modal -->
    <div id="propertyModal" class="modal">
        <div class="modal-content property-form-modal">
            <span class="close" onclick="closePropertyModal()">&times;</span>
            <h2 id="propertyModalTitle">Adicionar Imóvel</h2>
            <form id="propertyForm" class="property-form">
                <!-- Property form fields will be added via JavaScript -->
            </form>
        </div>
    </div>

    <!-- Broker Modal -->
    <div id="brokerModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeBrokerModal()">&times;</span>
            <h2 id="brokerModalTitle">Adicionar Corretor</h2>
            <form id="brokerForm">
                <!-- Broker form fields will be added via JavaScript -->
            </form>
        </div>
    </div>

    <!-- Repair Edit Modal -->
    <div id="repairEditModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeRepairEditModal()">&times;</span>
            <h2>Editar Status do Reparo</h2>
            <form onsubmit="saveRepairStatus(); return false;">
                <div class="form-group">
                    <label>Novo Status</label>
                    <select id="repairEditStatus">
                        <option value="pendente">Pendente</option>
                        <option value="em_analise">Em Análise</option>
                        <option value="em_andamento">Em Andamento</option>
                        <option value="concluido">Concluído</option>
                        <option value="cancelado">Cancelado</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Data da Visita (quando status = Em Andamento)</label>
                    <input type="datetime-local" id="repairEditVisitDate" placeholder="Opcional">
                </div>
                <div class="form-group">
                    <label>Mensagem/Observação (será enviada ao histórico)</label>
                    <textarea id="repairEditResponse" rows="3" placeholder="Ex: Visita agendada para verificação..."></textarea>
                </div>
                <p class="form-hint"><small>Ao mudar para "Em Andamento", o cliente recebe email de visita agendada. Ao mudar para "Concluído", recebe email de conclusão.</small></p>
                <div class="form-actions" style="margin-top:15px;">
                    <button type="button" class="btn btn-secondary" onclick="closeRepairEditModal()">Cancelar</button>
                    <button type="submit" class="btn btn-primary">Salvar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Notification Action Modal -->
    <div id="notificationActionModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeNotificationActionModal()">&times;</span>
            <div id="notificationActionContent">
                <!-- Notification action content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Notifications Panel -->
    <div id="notificationsPanel" class="notifications-panel">
        <div class="panel-header">
            <h3>Notificações</h3>
            <button class="close-panel" onclick="closeNotificationsPanel()">×</button>
        </div>
        <div class="panel-content" id="notificationsPanelContent">
            <!-- Quick notifications will be loaded here -->
        </div>
    </div>

    <!-- Scripts -->
    <script src="config.js"></script>
    <script src="js/audit.js"></script>
    <script src="js/email-service.js"></script>
    <!-- Firebase (Compat) -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-storage-compat.js"></script>
    <script src="js/firebase.js"></script>
    <script src="js/firebase-service.js"></script>
    <script src="js/main.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/properties.js"></script>
    <script src="js/reservations.js"></script>
    <script src="js/property-units.js"></script>
    <script src="js/pdf-seed-reservations.js"></script>
    <script src="js/pdf-import.js"></script>
    <script src="js/notifications.js"></script>
    <script src="js/documents.js"></script>
    <script src="js/sample-data.js"></script>
    <script src="js/property-sales.js"></script>
    <script src="js/whatsapp-leads.js"></script>
    <script src="js/admin-analytics.js"></script>
    <script src="js/admin-repairs.js?v=4"></script>
    <script src="js/admin.js?v=2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</body>
</html>
